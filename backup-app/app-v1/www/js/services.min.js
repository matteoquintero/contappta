angular.module("starter.services",[]).service("LoginService",function(a,c){var b=JSON.parse(localStorage.getItem("app")||"{}");return{loginUser:function(e,f){var d=a.defer();
var h=d.promise;console.log("asd");var g={method:"POST",url:b.controller+"login.php",headers:{"Content-Type":" application/json "},params:{user:e,password:f,devicetoken:localStorage.getItem("devicetoken"),idonesignal:localStorage.getItem("idonesignal")}};
c(g).then(function(j){console.log(j);if(j.data[0]===true){localStorage.setItem("user",JSON.stringify(j.data[1]));localStorage.setItem("institution",JSON.stringify(j.data[2]));
d.resolve();}else{d.reject();}});h.success=function(j){h.then(j);return h;};h.error=function(j){h.then(null,j);return h;};return h;}};}).service("notifications",function(f,a){var c=JSON.parse(localStorage.getItem("user")||"{}");
var e=JSON.parse(localStorage.getItem("app")||"{}");var b=c.idUsuario;console.log(c,"noti");var d={count:function(){var g={method:"POST",url:e.controller+"notifications.php",headers:{"Content-Type":" application/json "},params:{user:b}};
var h=f(g).then(function(j){a.$broadcast("noti");return j.data;});return h;}};return d;}).service("news",function(e){var b=JSON.parse(localStorage.getItem("user")||"{}");
var d=JSON.parse(localStorage.getItem("app")||"{}");var a=b.idUsuario;var c={all:function(){console.log("news");var f={method:"POST",url:d.controller+"news.php",headers:{"Content-Type":" application/json "},params:{reciver:a,mode:"news"}};
var g=e(f).then(function(h){if(h.data[0].data!=false){return h.data;}});return g;},get:function(h){var f={method:"POST",url:d.controller+"news.php",headers:{"Content-Type":" application/json "},params:{nevv:h,mode:"new"}};
var g=e(f).then(function(j){if(j.data[0].data!=false){return j.data[0];}});return g;},view:function(f){var g={method:"POST",url:d.controller+"new.php",headers:{"Content-Type":" application/json "},params:{user:f.user,nevv:f.nevv}};
return e(g).then();}};return c;}).service("magazines",function(f){var b=JSON.parse(localStorage.getItem("user")||"{}");var e=JSON.parse(localStorage.getItem("app")||"{}");
var c=b.idInstitucion;var a=b.idUsuario;var d={all:function(){var g={method:"POST",url:e.controller+"magazines.php",headers:{"Content-Type":" application/json "},params:{institution:c,mode:"magazines"}};
var h=f(g).then(function(j){if(j.data[0].data!=false){return j.data;}});return h;},view:function(g){var h={method:"POST",url:e.controller+"magazines.php",headers:{"Content-Type":" application/json "},params:{user:a,magazine:g,mode:"view"}};
return f(h).then();},pages:function(j){var g={method:"POST",url:e.controller+"magazines.php",headers:{"Content-Type":" application/json "},params:{magazine:j,mode:"pages"}};
var h=f(g).then(function(k){if(k.data[0].data!=false){return k.data;}});return h;}};return d;}).service("events",function(e){var b=JSON.parse(localStorage.getItem("user")||"{}");
var d=JSON.parse(localStorage.getItem("app")||"{}");var a=b.idUsuario;var c={calender:function(){var f={method:"POST",url:d.controller+"events.php",headers:{"Content-Type":" application/json "},params:{reciver:a,mode:"app-calender"}};
var g=e(f).then(function(j){if(j.data[0].data!=false){var l=[];for(var k=0;k<j.data.length;k++){var h=j.data[k]["fechaInicio"].split("-");l.push({date:new Date(parseInt(h[0]),(parseInt(h[1])-1),parseInt(h[2]))});
}localStorage.removeItem("events");localStorage.setItem("events",JSON.stringify(l));}});},date:function(g){var f={method:"POST",url:d.controller+"events.php",headers:{"Content-Type":" application/json "},params:{reciver:a,dateevent:g,mode:"app-date"}};
var h=e(f).then(function(j){if(j.data[0].data!=false){return j.data;}});return h;},eventId:function(h){var f={method:"POST",url:d.controller+"events.php",headers:{"Content-Type":" application/json "},params:{reciver:a,even:h,mode:"app-id"}};
var g=e(f).then(function(j){if(j.data[0]!=false){return j.data;}});return g;},view:function(f){var g={method:"POST",url:d.controller+"event.php",headers:{"Content-Type":" application/json "},params:{user:f.user,even:f.even}};
return e(g).then();}};return c;}).service("sons",function(e){var b=JSON.parse(localStorage.getItem("user")||"{}");var d=JSON.parse(localStorage.getItem("app")||"{}");
var a=b.idUsuario;var c={all:function(){var f={method:"POST",url:d.controller+"sons.php",headers:{"Content-Type":" application/json "},params:{user:a}};
var g=e(f).then(function(h){if(h.data[0].data!=false){return h.data;}});return g;}};return c;}).service("honors",function(c){var b=JSON.parse(localStorage.getItem("app")||"{}");
var a={get:function(f){var d={method:"POST",url:b.controller+"honors.php",headers:{"Content-Type":" application/json "},params:{user:f}};var e=c(d).then(function(g){if(g.data[0].data!=false){return g.data;
}});return e;}};return a;}).service("institutions",function(c){var b=JSON.parse(localStorage.getItem("app")||"{}");var a={get:function(f){var d={method:"POST",url:b.controller+"institutions.php",headers:{"Content-Type":" application/json "},params:{institution:f}};
var e=c(d).then(function(g){if(g.data[0].data!=false){return g.data;}});return e;}};return a;}).service("users",function(e){var c=JSON.parse(localStorage.getItem("app")||"{}");
var b=JSON.parse(localStorage.getItem("user")||"{}");var a=b.idUsuario;var d={contacts:function(){var f={method:"POST",url:c.controller+"users.php",headers:{"Content-Type":" application/json "},params:{institution:b.idInstitucion,mode:"users",user:a}};
var g=e(f).then(function(h){if(h.data!=false){return h.data;}});return g;},view:function(f){var g={method:"POST",url:c.controller+"users.php",headers:{"Content-Type":" application/json "},params:{parent:a,son:f.son,mode:"view"}};
var h=e(g).then(function(j){console.log("asd");});return h;},get:function(h){var f={method:"POST",url:c.controller+"users.php",headers:{"Content-Type":" application/json "},params:{user:h,mode:"user"}};
var g=e(f).then(function(j){if(j.data!=false){return j.data;}});return g;}};return d;}).service("chats",function(e){var b=JSON.parse(localStorage.getItem("user")||"{}");
var c=JSON.parse(localStorage.getItem("app")||"{}");var a=b.idUsuario;var d={all:function(){var f={method:"POST",url:c.controller+"chats.php",headers:{"Content-Type":" application/json "},params:{user:a,mode:"app-all"}};
var g=e(f).then(function(h){if(h.data[0].data!=false){return h.data;}});return g;},get:function(h){var f={method:"POST",url:c.controller+"messages.php",headers:{"Content-Type":" application/json "},params:{conversation:h,mode:"conversation"}};
var g=e(f).then(function(j){if(j.data[0].data!=false){return j.data;}});return g;},remove:function(f){console.log(f);for(i=f.length-1;i>=0;i--){console.log(f[i].field);
if(f[i].field=="money"){f.splice(i,1);}}}};return d;}).service("perfil",function(e){var d=JSON.parse(localStorage.getItem("app")||"{}");var c=JSON.parse(localStorage.getItem("user")||"{}");
var b=c.idUsuario;var a={update:function(f){var g={method:"POST",url:d.controller+"perfil.php",headers:{"Content-Type":" application/json "},params:{name:f.name,lastmane:f.lastname,email:f.email,password:f.password,user:b,}};
return e(g).then();},device:function(f,h){console.log(f);console.log(h);var g={method:"POST",url:d.controller+"device.php",headers:{"Content-Type":" application/json "},params:{devicetoken:h,idonesignal:f,user:b,}};
return e(g).then();},};return a;}).service("respuesta",function(c){var b=JSON.parse(localStorage.getItem("app")||"{}");var a={create:function(d){var e={method:"POST",url:b.controller+"respuesta.php",headers:{"Content-Type":" application/json "},params:{response:d.response,user:d.user,nevv:d.nevv}};
var f=c(e).then(function(g){if(g.data[0].data!=false){return g.data;}});return f;},};return a;}).service("mensaje",function(c){var b=JSON.parse(localStorage.getItem("app")||"{}");
var a={view:function(d){var e={method:"POST",url:b.controller+"mensaje.php",headers:{"Content-Type":" application/json "},params:{reciver:d.reciver,conversation:d.conversation,mode:"view"}};
return c(e).then();},kill:function(d){var e={method:"POST",url:b.controller+"mensaje.php",headers:{"Content-Type":" application/json "},params:{conversation:d.conversation,mode:"remove"}};
var f=c(e).then(function(g){if(g.data[0].data!=false){return g.data;}});return f;}};return a;}).service("Navigation",function(a){this.goNative=function(b,c,d){a.go(b,c);
window.plugins.nativepagetransitions.slide({direction:d},function(e){console.log("success: "+e);},function(e){alert("error: "+e);});};});